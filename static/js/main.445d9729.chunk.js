(this.webpackJsonpincome=this.webpackJsonpincome||[]).push([[0],{23:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(11),r=n.n(a),o=n(28),i=void 0;function c(){if(i)return i;if(i=r.a.initializeApp({apiKey:"AIzaSyCI77PrVU6FyFQN9OQhF8uo2ypHZQTQqSM",authDomain:"gleider-dev.firebaseapp.com",databaseURL:"https://gleider-dev.firebaseio.com",projectId:"gleider-dev",storageBucket:"",messagingSenderId:"868861057308",appId:"1:868861057308:web:72ab5d4b1e875ce7"}),"gleider.ml"!==window.location.hostname){i.firestore().settings({host:"localhost:3081",ssl:!1}),i.firestore().collection("usuarios").doc(o.uid).set(o)}return i}},28:function(e){e.exports=JSON.parse('{"uid":"IHwEIauTCEciFvMJRdmsrkjvSGr1","nome":"Gleider Costa","papel":"administrador"}')},40:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return u}));var a=n(0),r=n.n(a),o=n(11),i=n.n(o),c=n(23);n(41);e.firebase=i.a;var s={signInFlow:"popup",credentialHelper:e.firebaseui.auth.CredentialHelper.NONE,signInOptions:[i.a.auth.GoogleAuthProvider.PROVIDER_ID,{provider:i.a.auth.EmailAuthProvider.PROVIDER_ID,requireDisplayName:!0}],callbacks:{signInSuccessWithAuthResult:function(){return!1}}};function u(t){t.user;return Object(a.useEffect)((function(){var t=e.firebaseui.auth.AuthUI,n=Object(c.a)();(t.getInstance()||new t(n.auth())).start("#firebaseui-auth-container",s)})),r.a.createElement("div",{style:{background:"var(--mdc-theme-primary)",alignSelf:"center"}},"Conecte-se para enviar mensagens",r.a.createElement("div",{id:"firebaseui-auth-container"}))}}).call(this,n(17))},49:function(e,t,n){e.exports=n(95)},83:function(e,t,n){},84:function(e,t,n){},85:function(e,t,n){},86:function(e,t,n){},87:function(e,t,n){},88:function(e,t,n){},95:function(e,t,n){"use strict";n.r(t);var a=n(48),r=n(19),o=n.n(r),i=n(6),c=n(0),s=n.n(c),u=n(39),l=n.n(u),d=n(11),m=n.n(d),f=n(23),p=n(18),v=n.n(p),g=n(13),h=n.n(g),b=n(29),E=n.n(b),y=n(40);function w(e){var t=e.user,n=e.sign_in,a=e.open_sign_in,r=e.hideChat,o=s.a.createElement(p.Button,{id:"fab-docs",onClick:function(){return r()},style:{margin:"auto 8px auto auto",marginLeft:"auto",background:"var(--mdc-theme-secondary)",color:"var(--mdc-theme-on-secondary)",borderColor:"var(--mdc-theme-on-primary, #ffffff)"},icon:s.a.createElement(h.a,{icon:"description"})},"Documenta\xe7\xe3o"),i={color:"var(--mdc-theme-on-primary, #ffffff)",borderColor:"var(--mdc-theme-on-primary, #ffffff)",margin:"auto 8px"},c=t?s.a.createElement(p.Button,{outlined:!0,style:i,onClick:function(){return m.a.auth().signOut()}},"Desconectar"):s.a.createElement(p.Button,{outlined:!0,style:i,onClick:function(){return a(!n)},trailingIcon:s.a.createElement(h.a,{icon:n?"arrow_drop_up":"arrow_drop_down"})},n?"Cancelar":"Conectar");return s.a.createElement(E.a,{style:{position:"static"}},s.a.createElement(b.TopAppBarRow,null,c,o),n&&!t?s.a.createElement(y.a,{user:t}):null)}var x=n(14),O=n(34),j=(n(72),n(73),n(74),n(75),n(76),n(77),n(78),n(79),n(80),n(81),n(82),n(83),n(84),n(85),n(86),n(87),n(88),n(25)),C=n(24),k=n(43),S=n(44),I=n.n(S),L=n(45),R=n.n(L);function N(e){var t=e.inventionListener,n=e.inventionSave,a=e.showHeader,r=Object(c.useState)(!0),o=Object(i.a)(r,2),u=o[0],l=o[1],d=Object(c.useState)(""),m=Object(i.a)(d,2),f=m[0],p=m[1],g=Object(c.useState)(""),h=Object(i.a)(g,2),b=h[0],E=h[1];Object(c.useEffect)((function(){return t(p)}),[t,p]);var y=a?s.a.createElement("div",{style:{display:"flex",padding:"8px"}},s.a.createElement("label",{htmlFor:"my-switch",style:{marginRight:"12px"}},"Visualizar"),s.a.createElement(R.a,{checked:u,nativeControlId:"my-switch","data-testid":"switch",onChange:function(e){return l(e.target.checked)}}),s.a.createElement(v.a,{"data-testid":"save-button",className:b,raised:!0,style:{marginLeft:"auto"},onClick:function(){E("waiting"),n(f).then((function(){return E("")}))}},"Salvar")):null;return s.a.createElement(s.a.Fragment,null,y,s.a.createElement("div",{id:"doc-container"},u?s.a.createElement(F,{markdown:f}):s.a.createElement(_,{markdown:f,setMarkdown:p})))}function _(e){var t=e.markdown,n=e.setMarkdown,a=Object(c.useRef)(null);return s.a.createElement("div",{id:"markdown-editor",contentEditable:!0,suppressContentEditableWarning:!0,ref:a,"data-testid":"markdown",onBlur:function(e){return n(e.target.innerText)}},t)}function F(e){var t=e.markdown,n=new I.a.Converter({strikethrough:!0});n.setFlavor("github");var a=n.makeHtml(t);return s.a.createElement("div",{className:"income-doc","data-testid":"view",dangerouslySetInnerHTML:{__html:a}})}var M=n(30),H=n.n(M),P=n(31),A=n.n(P);function B(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.sendMsg,n=e.msgsListener,a=e.autor,r=Object(c.useState)(""),o=Object(i.a)(r,2),u=o[0],l=o[1],d=Object(c.useState)(!0),m=Object(i.a)(d,2),f=m[0],p=m[1],v=Object(c.useRef)(null),g=function(){Promise.resolve().then((function(){v.current.inputElement.style.height="auto"})).then((function(){var e=v.current.inputElement;e.style.height=e.scrollHeight+"px"}))},b=function(e){l(e),g()},E=function(){p(!0);var e=u;b(""),t(u,a).catch((function(){return b(e)}))},y=Object(c.useState)([]),w=Object(i.a)(y,2),x=w[0],O=w[1];Object(c.useEffect)((function(){return n(O)}),[n,O]);var j=20,k=0;return s.a.createElement(s.a.Fragment,null,s.a.createElement(D,Object.assign({key:""},{msgList:x,autoScroll:f,setAutoScroll:p})),s.a.createElement("div",{style:{display:"flex"}},s.a.createElement(A.a,{id:"MessageInput",className:"MessageInput",label:"Sua mensagem",outlined:!0,textarea:!0,style:{flex:1,height:"auto",margin:"8px"}},s.a.createElement(P.Input,{rows:"1",value:u,ref:v,"data-testid":"input",style:{margin:"8px",padding:"".concat(k,"px"),lineHeight:"".concat(j,"px"),height:"".concat(k+j,"px"),maxHeight:"".concat(k+4*j,"px"),resize:"none"},onChange:function(e){return b(e.currentTarget.value)}})),s.a.createElement(C.Fab,{mini:!0,icon:s.a.createElement(h.a,{icon:"send"}),"data-testid":"send",onClick:E,style:{margin:"auto",marginRight:"8px",color:"var(--mdc-theme-on-primary, #fff)",background:"var(--mdc-theme-primary, #6200ee)"}})))}function D(e){var t=e.msgList,n=e.autoScroll,a=e.setAutoScroll,r=Object(c.useRef)(null),o=Object(c.useRef)(null),u=t.map((function(e){return s.a.createElement(T,{key:e.id,msg:e})})),l=function(){r.current&&r.current.scrollIntoView&&r.current.scrollIntoView({behavior:"smooth"})};Object(c.useEffect)((function(){n&&l()}));var d=Object(c.useState)(!1),m=Object(i.a)(d,2),f=m[0],p=m[1];return Object(c.useEffect)((function(){n||p(!0)}),[t]),s.a.createElement("div",{className:"teste","data-testid":"msg-list",ref:o,style:{flexGrow:1,overflow:"auto",position:"relative"},onScroll:function(e){var t=e.target.getBoundingClientRect().bottom,n=r.current.previousSibling.getBoundingClientRect().bottom;a(Math.abs(n-t)<20)}},u,s.a.createElement("div",{ref:r}),s.a.createElement(C.Fab,{id:"scroll-down",className:f?"new-msgs":void 0,mini:!0,textLabel:f?"novas mensagens":void 0,exited:n,icon:s.a.createElement(h.a,{icon:"expand_more"}),onClick:function(){l(),p(!1)}}))}function T(e){var t=e.msg;return s.a.createElement(H.a,{outlined:!1,style:{margin:"8px"},"data-testid":"mensagem"},s.a.createElement(M.CardPrimaryContent,{style:{padding:"0px 4px"}},s.a.createElement("div",{"data-testid":"autor",style:{fontWeight:"bold"}},t.autor),s.a.createElement("div",{className:"msg-text","data-testid":"texto"},t.texto)))}var V=Object(f.a)(),G=V.firestore(),z=G.collection("invencoes"),J=m.a.firestore.FieldValue.serverTimestamp();function Q(e){var t=e.sendMsg,n=e.msgsListener,a=e.inventionListener,r=e.inventionSave,u=Object(c.useState)(void 0),l=Object(i.a)(u,2),d=l[0],m=l[1],f=Object(c.useState)(!1),p=Object(i.a)(f,2),v=p[0],g=p[1],b=Object(x.f)().contexto,E=void 0===b?"inicio":b,y=function(e){var t=Object(c.useState)("lendo"),n=Object(i.a)(t,2),a=n[0],r=n[1],o=z.doc(e);return Object(c.useEffect)((function(){return o.onSnapshot((function(e){return r(e.data()?"ok":"inexistente")}))})),{status:a}}(E).status,S=!!d&&"administrador"===d.papel;Object(c.useEffect)((function(){var e=void 0;return V.auth().onAuthStateChanged((function(t){if(t){var n=function(){var e;return o.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return e={uid:t.uid,nome:t.displayName,papel:"comum"},n.next=3,o.a.awrap(a.set(e));case 3:return n.abrupt("return",e);case 4:case"end":return n.stop()}}))};console.time("logging"),m({uid:t.uid,nome:t.displayName});var a=G.collection("usuarios").doc(t.uid);e=a.onSnapshot({includeMetadataChanges:!0},(function(t){return o.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(t.metadata.fromCache){a.next=12;break}if(a.t0=m,a.t1=t.data(),a.t1){a.next=7;break}return a.next=6,o.a.awrap(n());case 6:a.t1=a.sent;case 7:a.t2=a.t1,(0,a.t0)(a.t2),e(),e=void 0,console.timeEnd("logging");case 12:case"end":return a.stop()}}))}))}else m(void 0),e&&(e(),e=void 0),console.log("desconectado"),console.timeEnd("logging")}))}),[]);var I={sendMsg:function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return d?t.apply(void 0,n.concat([E])):(g(!0),Promise.reject("Usu\xe1rio n\xe3o conectado"))},msgsListener:function(e){return n(e,E)}},L=Object(c.useState)(window.innerWidth<=840?"none":"flex"),R=Object(i.a)(L,2),_=R[0],F=R[1];return s.a.createElement(k.Body1,{tag:"div"},s.a.createElement((function(){switch(y){case"lendo":return s.a.createElement("div",{style:{padding:"16px"}},"Carregando conte\xfado...");case"inexistente":if("inicio"!==E&&!S)return s.a.createElement("div",{style:{padding:"16px"}},s.a.createElement("p",null,"Desculpe, sistema ainda n\xe3o desenvolvido."),s.a.createElement("p",null,"Envie sua sugest\xe3o em nosso chat."),s.a.createElement("p",null,"Obrigado"),s.a.createElement(O.b,{to:"./"},"Voltar para o in\xedcio"))}return s.a.createElement(j.Grid,{style:{padding:0}},s.a.createElement(j.Row,{style:{gridGap:"0px"}},s.a.createElement(j.Cell,{id:"incomedocs",className:"vh100",phoneColumns:12,tabletColumns:12,desktopColumns:8},s.a.createElement(N,{showHeader:S,inventionSave:function(e){return r(e,E)},inventionListener:function(e){return a(E,e)}}),s.a.createElement(C.Fab,{id:"fab-chat",icon:s.a.createElement(h.a,{icon:"chat"}),onClick:function(){return F("flex")},textLabel:"Chat"})),s.a.createElement(j.Cell,{id:"incomechat",className:"vh100",phoneColumns:12,tabletColumns:12,desktopColumns:4,style:{display:_}},s.a.createElement(w,{user:d,sign_in:v,open_sign_in:g,hideChat:function(){return F("none")}}),s.a.createElement(B,Object.assign({autor:d,alertas:[]},I)))))}),null))}!function(){var e=function(){var e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh","".concat(e,"px"))};e(),window.addEventListener("resize",function(e){var t=!1;return function(){t||(t=setTimeout((function(){e(),t=!1}),15))}}(e))}();var U={sendMsg:function(e,t,n){return o.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(t){a.next=2;break}return a.abrupt("return",Promise.reject("Conecte-se para enviar mensagens"));case 2:if(!((e=e.trim()).length>0)){a.next=7;break}return a.abrupt("return",z.doc(n).collection("msgs").add({texto:e,timestamp:J,autor:t}));case 7:return a.abrupt("return",Promise.resolve());case 8:case"end":return a.stop()}}))},msgsListener:function(e,t){return z.doc(t).collection("msgs").orderBy("timestamp").onSnapshot((function(t){var n=[];t.forEach((function(e){n.push(Object(a.a)({},e.data(),{id:e.id,autor:e.data().autor.nome}))})),e(n)}),(function(e){return console.log(e)}))},inventionListener:function(e,t){return z.doc(e).onSnapshot((function(e){e.data()&&t(e.data().markdown)}),(function(e){return console.log(e)}))},inventionSave:function(e,t){return z.doc(t).collection("historico").add({markdown:e,timestamp:J}),z.doc(t).set({markdown:e}).catch((function(e){return Promise.reject(s.a.createElement("div",null,"error"))}))}};l.a.render(s.a.createElement((function(){return s.a.createElement(O.a,{basename:"/income"},s.a.createElement(x.c,null,s.a.createElement(x.a,{path:"/:contexto?",component:function(){return s.a.createElement(Q,U)}})))}),null),document.querySelector("#root"))}},[[49,1,2]]]);
//# sourceMappingURL=main.445d9729.chunk.js.map