(this.webpackJsonpincome=this.webpackJsonpincome||[]).push([[0],{34:function(e,t,n){e.exports=n(75)},56:function(e,t,n){},57:function(e,t,n){},58:function(e,t,n){},59:function(e,t,n){},60:function(e,t,n){},75:function(e,t,n){"use strict";n.r(t);var r=n(27),a=n(11),o=n.n(a),i=n(18),c=n(8),u=n(1),s=n.n(u),l=n(28),m=n.n(l),d=n(6),f=n.n(d);function p(){f.a.initializeApp({apiKey:"AIzaSyCI77PrVU6FyFQN9OQhF8uo2ypHZQTQqSM",authDomain:"gleider-dev.firebaseapp.com",databaseURL:"https://gleider-dev.firebaseio.com",projectId:"gleider-dev",storageBucket:"",messagingSenderId:"868861057308",appId:"1:868861057308:web:72ab5d4b1e875ce7"})}var g=n(9),v=n.n(g),h=n(10),b=n.n(h),y=n(19),E=n.n(y),w=n(20),O=n.n(w),j=n(26);try{f.a.app()}catch(K){p()}var k={signInFlow:"popup",credentialHelper:j.auth.CredentialHelper.NONE,signInOptions:[f.a.auth.GoogleAuthProvider.PROVIDER_ID,{provider:f.a.auth.EmailAuthProvider.PROVIDER_ID,requireDisplayName:!0}],callbacks:{signInSuccessWithAuthResult:function(){return!1}}};function x(e){return e.user?null:s.a.createElement("div",{style:{background:"var(--mdc-theme-primary)",alignSelf:"center"}},"Conecte-se para enviar mensagens",s.a.createElement(O.a,{uiConfig:k,firebaseAuth:f.a.auth()}))}function C(e){var t=e.user,n=e.sign_in,r=e.open_sign_in,a=e.hideChat,o=s.a.createElement(g.Button,{id:"fab-docs",onClick:function(){return a()},style:{margin:"auto 8px auto auto",marginLeft:"auto",background:"var(--mdc-theme-secondary)",color:"var(--mdc-theme-on-secondary)",borderColor:"var(--mdc-theme-on-primary, #ffffff)"},icon:s.a.createElement(b.a,{icon:"description"})},"Documenta\xe7\xe3o"),i={color:"var(--mdc-theme-on-primary, #ffffff)",borderColor:"var(--mdc-theme-on-primary, #ffffff)",margin:"auto 8px"},c=t?s.a.createElement(g.Button,{outlined:!0,style:i,onClick:function(){return f.a.auth().signOut()}},"Desconectar"):s.a.createElement(g.Button,{outlined:!0,style:i,onClick:function(){return r(!n)},trailingIcon:s.a.createElement(b.a,{icon:n?"arrow_drop_up":"arrow_drop_down"})},n?"Cancelar":"Conectar"),l=Object(u.useMemo)((function(){return s.a.createElement(x,{user:t})}),[t]);return s.a.createElement(E.a,{style:{position:"static"}},s.a.createElement(y.TopAppBarRow,null,c,o),n?l:null)}n(56),n(57),n(58),n(59),n(60),n(61),n(62),n(63),n(64),n(65),n(66),n(67),n(68),n(69),n(70),n(71);var S=n(14),I=n(17),P=n(31),L=n(32),D=n.n(L),R=n(33),_=n.n(R);function F(e){var t=e.inventionListener,n=e.inventionSave,r=e.showHeader,a=Object(u.useState)(!0),o=Object(c.a)(a,2),i=o[0],l=o[1],m=Object(u.useState)(""),d=Object(c.a)(m,2),f=d[0],p=d[1];Object(u.useEffect)((function(){return t(p)}),[t,p]);var g=r?s.a.createElement("div",{style:{display:"flex",padding:"8px"}},s.a.createElement("label",{htmlFor:"my-switch",style:{marginRight:"12px"}},"Visualizar"),s.a.createElement(_.a,{checked:i,nativeControlId:"my-switch","data-testid":"switch",onChange:function(e){return l(e.target.checked)}}),s.a.createElement(v.a,{raised:!0,style:{marginLeft:"auto"},onClick:function(){return n(f)}},"Salvar")):null;return s.a.createElement(s.a.Fragment,null,g,s.a.createElement("div",{style:{flexGrow:1,overflow:"auto",padding:"8px"}},i?s.a.createElement(M,{markdown:f}):s.a.createElement(B,{markdown:f,setMarkdown:p})))}function B(e){var t=e.markdown,n=e.setMarkdown;return s.a.createElement("div",{contentEditable:!0,suppressContentEditableWarning:!0,onBlur:function(e){return n(e.target.innerText)},style:{whiteSpace:"pre-wrap",WebkitUserModify:"read-write",overflowWrap:"break-word",lineBreak:"after-white-space",lineHeight:"1em",fontFamily:"monospace",display:"inline-block"}},t)}function M(e){var t=e.markdown,n=new D.a.Converter({strikethrough:!0});n.setFlavor("github");var r=n.makeHtml(t);return s.a.createElement("div",{className:"income-doc",dangerouslySetInnerHTML:{__html:r}})}var N=n(21),H=n.n(N),A=n(22),T=n.n(A);function V(e){var t=e||{},n=t.sendMsg,r=t.msgsListener,a=(e||{}).autor,o=Object(u.useState)(""),i=Object(c.a)(o,2),l=i[0],m=i[1],d=function(){n(l,a).then((function(){return m("")})).catch(console.error)},f=Object(u.useState)([]),p=Object(c.a)(f,2),g=p[0],v=p[1];return Object(u.useEffect)((function(){return r(v)}),[r,v]),s.a.createElement(s.a.Fragment,null,s.a.createElement(W,{msgList:g}),s.a.createElement("div",{style:{display:"flex"}},s.a.createElement(T.a,{label:"Sua mensagem",outlined:!0,style:{flex:1,height:"40px",margin:"8px"}},s.a.createElement(A.Input,{style:{height:"40px"},onKeyDown:function(e){"Enter"===e.key&&(e.persist(),d())},value:l,onChange:function(e){return m(e.currentTarget.value)}})),s.a.createElement(I.Fab,{mini:!0,icon:s.a.createElement(b.a,{icon:"send"}),onClick:d,style:{margin:"auto",marginRight:"8px",color:"var(--mdc-theme-on-primary, #fff)",background:"var(--mdc-theme-primary, #6200ee)"}})))}function W(e){var t=e.msgList,n=Object(u.useRef)(null),r=Object(u.useRef)(null),a=Object(u.useState)(!0),o=Object(c.a)(a,2),i=o[0],l=o[1],m=t.map((function(e){return s.a.createElement(z,{key:e.id,msg:e})}));return Object(u.useEffect)((function(){if(n.current.previousSibling){var e=r.current.getBoundingClientRect().bottom,t=n.current.previousSibling.getBoundingClientRect().top;console.log(n.current),console.log({bottomList:e,topFim:t,a:i}),i?(l(!1),n.current.scrollIntoView()):t-e<100&&n.current.scrollIntoView({behavior:"smooth"})}}),[t,i]),s.a.createElement("div",{className:"teste",style:{flexGrow:1,overflow:"auto",position:"relative"},ref:r},m,s.a.createElement("div",{ref:n}))}function z(e){var t=e.msg;return s.a.createElement(H.a,{outlined:!1,style:{margin:"8px"},"data-testid":"mensagem"},s.a.createElement(N.CardPrimaryContent,{style:{padding:"0px 4px"}},s.a.createElement("div",{"data-testid":"autor",style:{fontWeight:"bold"}},t.autor),s.a.createElement("div",{"data-testid":"texto"},t.texto)))}function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}try{f.a.app()}catch(K){p()}var Q=f.a.firestore(),U=Q.collection("invencoes"),q=f.a.firestore.FieldValue.serverTimestamp();function J(){return(J=Object(i.a)(o.a.mark((function e(t,n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return",Promise.reject("Conecte-se para enviar mensagens"));case 2:if(!((t=t.trim()).length>0)){e.next=7;break}return e.abrupt("return",U.doc("income").collection("msgs").add({texto:t,timestamp:q,autor:n}));case 7:return e.abrupt("return",Promise.resolve());case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){var e=function(){var e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh","".concat(e,"px"))};e(),window.addEventListener("resize",function(e){var t=!1;return function(){t||(t=setTimeout((function(){e(),t=!1}),15))}}(e))}(),m.a.render(s.a.createElement((function(e){var t=e.sendMsg,n=e.msgsListener,r=e.inventionListener,a=e.inventionSave,l=Object(u.useState)(void 0),m=Object(c.a)(l,2),d=m[0],p=m[1],g=Object(u.useState)("income"),v=Object(c.a)(g,2),h=v[0],y=(v[1],Object(u.useState)(!1)),E=Object(c.a)(y,2),w=E[0],O=E[1];Object(u.useEffect)((function(){var e=void 0;return f.a.auth().onAuthStateChanged((function(t){if(t){var n=function(){var t=Object(i.a)(o.a.mark((function t(n){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.metadata.fromCache){t.next=12;break}if(t.t0=p,t.t1=n.data(),t.t1){t.next=7;break}return t.next=6,r();case 6:t.t1=t.sent;case 7:t.t2=t.t1,(0,t.t0)(t.t2),e(),e=void 0,console.timeEnd("logging");case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),r=function(){var e=Object(i.a)(o.a.mark((function e(){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={uid:t.uid,nome:t.displayName,papel:"comum"},e.next=3,a.set(n);case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();console.time("logging"),p({uid:t.uid,nome:t.displayName});var a=Q.collection("usuarios").doc(t.uid);e=a.onSnapshot({includeMetadataChanges:!0},n)}else p(void 0),e&&(e(),e=void 0),console.log("desconectado"),console.timeEnd("logging")}))}),[]);var j={sendMsg:function(){return d?t.apply(void 0,arguments):(O(!0),Promise.reject("Usu\xe1rio n\xe3o conectado"))},msgsListener:n},k=Object(u.useState)("flex"),x=Object(c.a)(k,2),L=x[0],D=(x[1],Object(u.useState)(window.innerWidth<=840?"none":"flex")),R=Object(c.a)(D,2),_=R[0],B=R[1];return s.a.createElement(P.Body1,{tag:"div"},s.a.createElement(S.Grid,{style:{padding:0}},s.a.createElement(S.Row,{style:{gridGap:"0px"}},s.a.createElement(S.Cell,{id:"incomedocs",className:"vh100",phoneColumns:12,tabletColumns:12,desktopColumns:8,style:{display:L,flexDirection:"column",position:"relative"}},s.a.createElement(F,{showHeader:!!d&&"administrador"===d.papel,inventionSave:function(e){return a(e,h,d)},inventionListener:function(e){return r(h,e)}}),s.a.createElement(I.Fab,{id:"fab-chat",icon:s.a.createElement(b.a,{icon:"chat"}),onClick:function(){return B("flex")},style:{margin:"16px",position:"absolute",bottom:"0px",right:"0px",zIndex:0,color:"var(--mdc-theme-on-primary, #fff)",background:"var(--mdc-theme-primary, #6200ee)"}})),s.a.createElement(S.Cell,{id:"incomechat",className:"vh100",phoneColumns:12,tabletColumns:12,desktopColumns:4,style:{display:_,flexDirection:"column",background:"white",width:"100%"}},s.a.createElement(C,{user:d,sign_in:w,open_sign_in:O,hideChat:function(){return B("none")}}),s.a.createElement(V,Object.assign({autor:d,alertas:[]},j))))))}),{sendMsg:function(e,t){return J.apply(this,arguments)},msgsListener:function(e){return U.doc("income").collection("msgs").orderBy("timestamp").onSnapshot((function(t){var n=[];t.forEach((function(e){n.push(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(n,!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e.data(),{id:e.id,autor:e.data().autor.nome}))})),e(n)}),(function(e){return console.log(e)}))},inventionListener:function(e,t){return U.doc(e).onSnapshot((function(e){e.data()&&t(e.data().markdown)}),(function(e){return console.log(e)}))},inventionSave:function(e,t,n){return U.doc(t).collection("historico").add({markdown:e,timestamp:q}),console.log("salvando..."),U.doc(t).set({markdown:e}).then((function(e){return console.log("salvo",e)})).catch((function(e){return Promise.reject(s.a.createElement("div",null,"error"))}))}}),document.querySelector("#root"))}},[[34,1,2]]]);
//# sourceMappingURL=main.87533756.chunk.js.map