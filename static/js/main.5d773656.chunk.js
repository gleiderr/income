(this.webpackJsonpincome=this.webpackJsonpincome||[]).push([[0],{31:function(e,t,n){e.exports=n(67)},49:function(e,t,n){},50:function(e,t,n){},51:function(e,t,n){},52:function(e,t,n){},53:function(e,t,n){},67:function(e,t,n){"use strict";n.r(t);var r=n(24),a=n(10),o=n.n(a),i=n(17),c=n(7),s=n(1),u=n.n(s),l=n(25),m=n.n(l),d=n(4),f=n.n(d);function p(){f.a.initializeApp({apiKey:"AIzaSyCI77PrVU6FyFQN9OQhF8uo2ypHZQTQqSM",authDomain:"gleider-dev.firebaseapp.com",databaseURL:"https://gleider-dev.firebaseio.com",projectId:"gleider-dev",storageBucket:"",messagingSenderId:"868861057308",appId:"1:868861057308:web:72ab5d4b1e875ce7"})}var v=n(8),g=n.n(v),h=n(9),b=n.n(h),y=n(15),E=n.n(y),w=n(18),O=n.n(w),k=n(23);try{f.a.app()}catch(K){p()}var j={signInFlow:"popup",credentialHelper:k.auth.CredentialHelper.NONE,signInOptions:[f.a.auth.GoogleAuthProvider.PROVIDER_ID,{provider:f.a.auth.EmailAuthProvider.PROVIDER_ID,requireDisplayName:!0}],callbacks:{signInSuccessWithAuthResult:function(){return!1}}};function x(e){return e.user?null:u.a.createElement("div",{style:{background:"var(--mdc-theme-primary)",alignSelf:"center"}},"Conecte-se para enviar mensagens",u.a.createElement(O.a,{uiConfig:j,firebaseAuth:f.a.auth()}))}function C(e){var t=e.user,n=e.sign_in,r=e.open_sign_in,a=u.a.createElement(v.Button,{id:"fab-docs",href:"#incomedocs",style:{margin:"auto 8px auto auto",marginLeft:"auto",background:"var(--mdc-theme-secondary)",color:"var(--mdc-theme-on-secondary)",borderColor:"var(--mdc-theme-on-primary, #ffffff)"},icon:u.a.createElement(b.a,{icon:"description"})},"Documenta\xe7\xe3o"),o={color:"var(--mdc-theme-on-primary, #ffffff)",borderColor:"var(--mdc-theme-on-primary, #ffffff)",margin:"auto 8px"},i=t?u.a.createElement(v.Button,{outlined:!0,style:o,onClick:function(){return f.a.auth().signOut()}},"Desconectar"):u.a.createElement(v.Button,{outlined:!0,style:o,onClick:function(){return r(!n)},trailingIcon:u.a.createElement(b.a,{icon:n?"arrow_drop_up":"arrow_drop_down"})},n?"Cancelar":"Conectar"),c=Object(s.useMemo)((function(){return u.a.createElement(x,{user:t})}),[t]);return u.a.createElement(E.a,{style:{position:"static"}},u.a.createElement(y.TopAppBarRow,null,i,a),n?c:null)}n(49),n(50),n(51),n(52),n(53),n(54),n(55),n(56),n(57),n(58),n(59),n(60),n(61),n(62),n(63);var S=n(12),I=n(16),P=n(28),L=n(29),D=n.n(L),R=n(30),_=n.n(R);function F(e){var t=e.inventionListener,n=e.inventionSave,r=e.showHeader,a=Object(s.useState)(!0),o=Object(c.a)(a,2),i=o[0],l=o[1],m=Object(s.useState)(""),d=Object(c.a)(m,2),f=d[0],p=d[1];Object(s.useEffect)((function(){return t(p)}),[t,p]);var v=r?u.a.createElement("div",{style:{display:"flex",padding:"8px"}},u.a.createElement("label",{htmlFor:"my-switch",style:{marginRight:"12px"}},"Visualizar"),u.a.createElement(_.a,{checked:i,nativeControlId:"my-switch","data-testid":"switch",onChange:function(e){return l(e.target.checked)}}),u.a.createElement(g.a,{raised:!0,style:{marginLeft:"auto"},onClick:function(){return n(f)}},"Salvar")):null;return u.a.createElement(u.a.Fragment,null,v,u.a.createElement("div",{style:{flexGrow:1,overflow:"auto",padding:"8px"}},i?u.a.createElement(M,{markdown:f}):u.a.createElement(B,{markdown:f,setMarkdown:p})))}function B(e){var t=e.markdown,n=e.setMarkdown;return u.a.createElement("div",{contentEditable:!0,suppressContentEditableWarning:!0,onBlur:function(e){return n(e.target.innerText)},style:{whiteSpace:"pre-wrap",WebkitUserModify:"read-write",overflowWrap:"break-word",lineBreak:"after-white-space",lineHeight:"1em",fontFamily:"monospace",display:"inline-block"}},t)}function M(e){var t=e.markdown,n=new D.a.Converter({strikethrough:!0});n.setFlavor("github");var r=n.makeHtml(t);return u.a.createElement("div",{className:"income-doc",dangerouslySetInnerHTML:{__html:r}})}var N=n(19),H=n.n(N),V=n(20),A=n.n(V);function T(e){var t=e||{},n=t.sendMsg,r=t.msgsListener,a=(e||{}).autor,o=Object(s.useState)(""),i=Object(c.a)(o,2),l=i[0],m=i[1],d=function(){n(l,a).then((function(){return m("")})).catch(console.error)},f=Object(s.useState)([]),p=Object(c.a)(f,2),v=p[0],g=p[1];return Object(s.useEffect)((function(){return r(g)}),[r,g]),u.a.createElement(u.a.Fragment,null,u.a.createElement(q,{msgList:v}),u.a.createElement("div",{style:{display:"flex"}},u.a.createElement(A.a,{label:"Sua mensagem",outlined:!0,style:{flex:1,height:"40px",margin:"8px"}},u.a.createElement(V.Input,{style:{height:"40px"},onKeyDown:function(e){"Enter"===e.key&&(e.persist(),d())},value:l,onChange:function(e){return m(e.currentTarget.value)}})),u.a.createElement(I.Fab,{mini:!0,icon:u.a.createElement(b.a,{icon:"send"}),onClick:d,style:{margin:"auto",marginRight:"8px",color:"var(--mdc-theme-on-primary, #fff)",background:"var(--mdc-theme-primary, #6200ee)"}})))}function q(e){var t=e.msgList,n=Object(s.useRef)(null),r=Object(s.useRef)(null),a=Object(s.useState)(!0),o=Object(c.a)(a,2),i=o[0],l=o[1],m=t.map((function(e){return u.a.createElement(G,{key:e.id,msg:e})}));return Object(s.useEffect)((function(){if(n.current.previousSibling){var e=r.current.getBoundingClientRect().bottom,t=n.current.previousSibling.getBoundingClientRect().top;console.log(n.current),console.log({bottomList:e,topFim:t,a:i}),i?(l(!1),n.current.scrollIntoView()):t-e<100&&n.current.scrollIntoView({behavior:"smooth"})}}),[t,i]),u.a.createElement("div",{className:"teste",style:{flexGrow:1,overflow:"auto",position:"relative"},ref:r},m,u.a.createElement("div",{ref:n}))}function G(e){var t=e.msg;return u.a.createElement(H.a,{outlined:!1,style:{margin:"8px"},"data-testid":"mensagem"},u.a.createElement(N.CardPrimaryContent,{style:{padding:"0px 4px"}},u.a.createElement("div",{"data-testid":"autor",style:{fontWeight:"bold"}},t.autor),u.a.createElement("div",{"data-testid":"texto"},t.texto)))}function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}try{f.a.app()}catch(K){p()}var z=f.a.firestore(),Q=z.collection("invencoes"),U=f.a.firestore.FieldValue.serverTimestamp();function J(){return(J=Object(i.a)(o.a.mark((function e(t,n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return",Promise.reject("Conecte-se para enviar mensagens"));case 2:if(!((t=t.trim()).length>0)){e.next=7;break}return e.abrupt("return",Q.doc("income").collection("msgs").add({texto:t,timestamp:U,autor:n}));case 7:return e.abrupt("return",Promise.resolve());case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){var e=function(e){var t=!1;return function(){t||(t=setTimeout((function(){e(),t=!1}),15))}},t=function(){var e,t=window.location.hash,n=void 0===t?"#incomedocs":t;switch(n){case"#incomedocs":case"#incomechat":(e=document.querySelector(n))&&e.scrollIntoView();break;default:(e=document.querySelector("#incomedocs"))&&e.scrollIntoView()}},n=function(){var e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh","".concat(e,"px")),t()};n(),window.addEventListener("resize",e(n)),window.addEventListener("scroll",e(t))}(),m.a.render(u.a.createElement((function(e){var t=e.sendMsg,n=e.msgsListener,r=e.inventionListener,a=e.inventionSave,l=Object(s.useState)(void 0),m=Object(c.a)(l,2),d=m[0],p=m[1],v=Object(s.useState)("income"),g=Object(c.a)(v,2),h=g[0],y=(g[1],Object(s.useState)(!1)),E=Object(c.a)(y,2),w=E[0],O=E[1];Object(s.useEffect)((function(){var e=void 0;return f.a.auth().onAuthStateChanged((function(t){if(t){var n=function(){var t=Object(i.a)(o.a.mark((function t(n){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.metadata.fromCache){t.next=12;break}if(t.t0=p,t.t1=n.data(),t.t1){t.next=7;break}return t.next=6,r();case 6:t.t1=t.sent;case 7:t.t2=t.t1,(0,t.t0)(t.t2),e(),e=void 0,console.timeEnd("logging");case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),r=function(){var e=Object(i.a)(o.a.mark((function e(){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={uid:t.uid,nome:t.displayName,papel:"comum"},e.next=3,a.set(n);case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();console.time("logging"),p({uid:t.uid,nome:t.displayName});var a=z.collection("usuarios").doc(t.uid);e=a.onSnapshot({includeMetadataChanges:!0},n)}else p(void 0),e&&(e(),e=void 0),console.log("desconectado"),console.timeEnd("logging")}))}),[]);var k={sendMsg:function(){return d?t.apply(void 0,arguments):(O(!0),Promise.reject("Usu\xe1rio n\xe3o conectado"))},msgsListener:n};return u.a.createElement(P.Body1,{tag:"div"},u.a.createElement(S.Grid,{style:{padding:0}},u.a.createElement(S.Row,{style:{gridGap:"0px"}},u.a.createElement(S.Cell,{id:"incomedocs",className:"vh100",phoneColumns:12,tabletColumns:12,desktopColumns:8,style:{display:"flex",flexDirection:"column",position:"relative"}},u.a.createElement(F,{showHeader:!!d&&"administrador"===d.papel,inventionSave:function(e){return a(e,h,d)},inventionListener:function(e){return r(h,e)}}),u.a.createElement("a",{id:"fab-chat",style:{margin:"16px",position:"absolute",bottom:"0px",right:"0px"},href:"#incomechat"},u.a.createElement(I.Fab,{icon:u.a.createElement(b.a,{icon:"chat"}),style:{color:"var(--mdc-theme-on-primary, #fff)",background:"var(--mdc-theme-primary, #6200ee)"}}))),u.a.createElement(S.Cell,{id:"incomechat",className:"vh100",phoneColumns:12,tabletColumns:12,desktopColumns:4,style:{display:"flex",flexDirection:"column",position:"relative"}},u.a.createElement(C,{user:d,sign_in:w,open_sign_in:O}),u.a.createElement(T,Object.assign({autor:d,alertas:[]},k))))))}),{sendMsg:function(e,t){return J.apply(this,arguments)},msgsListener:function(e){return Q.doc("income").collection("msgs").orderBy("timestamp").onSnapshot((function(t){var n=[];t.forEach((function(e){n.push(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(n,!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e.data(),{id:e.id,autor:e.data().autor.nome}))})),e(n)}),(function(e){return console.log(e)}))},inventionListener:function(e,t){return Q.doc(e).onSnapshot((function(e){e.data()&&t(e.data().markdown)}),(function(e){return console.log(e)}))},inventionSave:function(e,t,n){return Q.doc(t).collection("historico").add({markdown:e,timestamp:U}),console.log("salvando..."),Q.doc(t).set({markdown:e}).then((function(e){return console.log("salvo",e)})).catch((function(e){return Promise.reject(u.a.createElement("div",null,"error"))}))}}),document.querySelector("#root"))}},[[31,1,2]]]);
//# sourceMappingURL=main.5d773656.chunk.js.map